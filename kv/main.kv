#:kivy 2.3.0
#:import dp kivy.metrics.dp
#:import FadeTransition kivy.uix.screenmanager.FadeTransition

ScreenManager:
    id: screen_manager
    transition: FadeTransition()
    HomeScreen:
        name: "home"
    InfoScreen:
        name: "info"
    PersonalityTestScreen:
        name: "personality"
    ScientistMatcherScreen:
        name: "scientist"
    RPSCameraGameScreen:
        name: "rps"
    MazeGameScreen:
        name: "maze"
    CircuitGameScreen:
        name: "circuit"


<HomeScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(24)
        spacing: dp(24)

        canvas.before:
            Color:
                rgba: 0.05, 0.05, 0.1, 1
            Rectangle:
                pos: self.pos
                size: self.size

        # Titlu
        Label:
            text: "Universitatea XYZ"
            font_size: "48sp"
            bold: True
            size_hint_y: 0.2

        # Status prezenÈ›Äƒ
        Label:
            text: "Apropie-te de ecran pentru a Ã®ncepe" if not app.person_present else "Bun venit! Atinge un buton pentru a explora."
            font_size: "24sp"
            size_hint_y: 0.15

        # Butoanele principale
        GridLayout:
            cols: 2
            spacing: dp(16)
            size_hint_y: 0.65

            Button:
                text: "InformaÈ›ii despre universitate"
                font_size: "20sp"
                on_press: root.manager.current = "info"
                disabled: not app.person_present

            Button:
                text: "Test de personalitate"
                font_size: "20sp"
                on_press: root.manager.current = "personality"
                disabled: not app.person_present

            Button:
                text: "Oameni de È™tiinÈ›Äƒ care Ã®È›i seamÄƒnÄƒ"
                text_size: self.size
                halign: "center"
                valign: "middle"
                font_size: "20sp"
                on_press: root.manager.current = "scientist"
                disabled: not app.person_present

            Button:
                text: "JoacÄƒ piatrÄƒ-foarfecÄƒ-hÃ¢rtie la camerÄƒ"
                text_size: self.size
                halign: "center"
                valign: "middle"
                font_size: "20sp"
                on_press: root.manager.current = "rps"
                disabled: not app.person_present

            Button:
                text: "Labirint (touch)"
                text_size: self.size
                halign: "center"
                valign: "middle"
                font_size: "20sp"
                on_press: root.manager.current = "maze"
                disabled: not app.person_present

            Button:
                text: "Circuitul Magic"
                text_size: self.size
                halign: "center"
                valign: "middle"
                font_size: "20sp"
                on_press: root.manager.current = "circuit"
                disabled: not app.person_present


<InfoScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(24)
        spacing: dp(24)

        canvas.before:
            Color:
                rgba: 0.08, 0.08, 0.12, 1
            Rectangle:
                pos: self.pos
                size: self.size

        Label:
            text: "InformaÈ›ii despre universitate"
            font_size: "36sp"
            size_hint_y: 0.2

        Label:
            text: "Aici poÈ›i adÄƒuga o descriere a universitÄƒÈ›ii, facultÄƒÈ›i, avantaje,\\nprograme de studiu, oportunitÄƒÈ›i internaÈ›ionale etc."
            font_size: "20sp"
            text_size: self.width * 0.9, None
            halign: "center"
            valign: "middle"
            size_hint_y: 0.6

        BoxLayout:
            size_hint_y: 0.2
            spacing: dp(16)

            Button:
                text: "Deschide site-ul universitÄƒÈ›ii"
                font_size: "20sp"
                on_press: app.open_university_website()

            Button:
                text: "ÃŽnapoi"
                font_size: "20sp"
                on_press: app.go_home()


<PersonalityTestScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(24)
        spacing: dp(24)

        canvas.before:
            Color:
                rgba: 0.05, 0.1, 0.12, 1
            Rectangle:
                pos: self.pos
                size: self.size

        Label:
            text: "Test de personalitate"
            font_size: "36sp"
            size_hint_y: 0.2
        Label:
            text: app.personality_progress
            font_size: "18sp"
            size_hint_y: 0.1

        Label:
            id: question_label
            text: app.personality_question_text
            font_size: "22sp"
            halign: "center"
            valign: "middle"
            text_size: self.width * 0.9, None
            size_hint_y: 0.25

        GridLayout:
            cols: 1
            spacing: dp(12)
            size_hint_y: 0.35

            Button:
                text: app.personality_options[0] if len(app.personality_options) > 0 else " "
                font_size: "20sp"
                disabled: len(app.personality_options) < 1
                on_press: app.select_personality_answer(0)
            Button:
                text: app.personality_options[1] if len(app.personality_options) > 1 else " "
                font_size: "20sp"
                disabled: len(app.personality_options) < 2
                on_press: app.select_personality_answer(1)
            Button:
                text: app.personality_options[2] if len(app.personality_options) > 2 else " "
                font_size: "20sp"
                disabled: len(app.personality_options) < 3
                on_press: app.select_personality_answer(2)
            Button:
                text: app.personality_options[3] if len(app.personality_options) > 3 else " "
                font_size: "20sp"
                disabled: len(app.personality_options) < 4
                on_press: app.select_personality_answer(3)

        Label:
            text: app.personality_result_text
            font_size: "20sp"
            halign: "center"
            valign: "middle"
            text_size: self.size
            size_hint_y: 0.2

        Button:
            text: "ReporneÈ™te testul"
            font_size: "20sp"
            size_hint_y: 0.15
            on_press: app._reset_personality_test()

        Button:
            text: "ÃŽnapoi"
            font_size: "20sp"
            size_hint_y: 0.15
            on_press: app.go_home()


<ScientistMatcherScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(24)
        spacing: dp(24)

        canvas.before:
            Color:
                rgba: 0.07, 0.07, 0.15, 1
            Rectangle:
                pos: self.pos
                size: self.size

        Label:
            text: "Oameni de È™tiinÈ›Äƒ care Ã®È›i seamÄƒnÄƒ"
            font_size: "36sp"
            size_hint_y: 0.2

        Label:
            text: app.scientist_status_text
            font_size: "20sp"
            halign: "center"
            valign: "middle"
            text_size: self.size
            size_hint_y: 0.6

        Button:
            text: "FÄƒ o pozÄƒ È™i gÄƒseÈ™te potrivirea"
            font_size: "20sp"
            size_hint_y: 0.15
            on_press: app.capture_scientist_match()

        Button:
            text: "ÃŽnapoi"
            font_size: "20sp"
            size_hint_y: 0.15
            on_press: app.go_home()


<RPSCameraGameScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(24)
        spacing: dp(24)

        canvas.before:
            Color:
                rgba: 0.03, 0.09, 0.15, 1
            Rectangle:
                pos: self.pos
                size: self.size

        Label:
            text: "Piatra - FoarfecÄƒ - HÃ¢rtie (camera)"
            font_size: "36sp"
            size_hint_y: 0.2

        Label:
            text: app.rps_status_text
            font_size: "20sp"
            halign: "center"
            valign: "middle"
            text_size: self.size
            size_hint_y: 0.6

        Button:
            text: "JoacÄƒ o rundÄƒ"
            font_size: "20sp"
            size_hint_y: 0.15
            on_press: app.play_rps_round()

        Button:
            text: "ÃŽnapoi"
            font_size: "20sp"
            size_hint_y: 0.15
            on_press: app.go_home()


<MazeGameScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(24)
        spacing: dp(24)

        canvas.before:
            Color:
                rgba: 0.05, 0.12, 0.08, 1
            Rectangle:
                pos: self.pos
                size: self.size

        Label:
            text: "Labirint (touch)"
            font_size: "36sp"
            size_hint_y: 0.15

        Label:
            text: app.maze_status_text
            font_size: "18sp"
            size_hint_y: 0.1

        Label:
            text: "LegendÄƒ: ðŸ™‚ = start, â˜… = ieÈ™ire, blocuri pline = pereÈ›i"
            font_size: "16sp"
            size_hint_y: 0.08

        BoxLayout:
            size_hint_y: 0.45
            padding: dp(8)
            canvas.before:
                Color:
                    rgba: 0.8, 0.8, 0.9, 1
                Line:
                    width: 2
                    rectangle: (self.x, self.y, self.width, self.height)

            Label:
                text: app.maze_display_text
                font_size: "20sp"
                markup: True
                halign: "center"
                valign: "middle"
                text_size: self.size

        GridLayout:
            cols: 3
            spacing: dp(12)
            size_hint_y: 0.2

            Widget:
            Button:
                text: "^ Sus"
                font_size: "22sp"
                on_press: app.move_maze("up")
            Widget:

            Button:
                text: "< StÃ¢nga"
                font_size: "22sp"
                on_press: app.move_maze("left")
            Widget:
            Button:
                text: "> Dreapta"
                font_size: "22sp"
                on_press: app.move_maze("right")

            Widget:
            Button:
                text: "v Jos"
                font_size: "22sp"
                on_press: app.move_maze("down")
            Widget:

        BoxLayout:
            size_hint_y: 0.15
            spacing: dp(16)

            Button:
                text: "ReporneÈ™te"
                font_size: "20sp"
                on_press: app._reset_maze()

            Button:
                text: "ÃŽnapoi"
                font_size: "20sp"
                on_press: app.go_home()


<CircuitGameScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(24)
        spacing: dp(24)

        canvas.before:
            Color:
                rgba: 0.1, 0.05, 0.1, 1
            Rectangle:
                pos: self.pos
                size: self.size

        Label:
            text: "Circuitul Magic"
            font_size: "36sp"
            size_hint_y: 0.15

        Label:
            text: "PlaseazÄƒ firele sus È™i jos, apoi porneÈ™te Ã®ntrerupÄƒtorul.\nCÃ¢nd circuitul e complet, becul se aprinde."
            font_size: "18sp"
            halign: "center"
            valign: "middle"
            text_size: self.width * 0.95, None
            size_hint_y: 0.15

        Label:
            text: app.circuit_board_text
            font_size: "20sp"
            markup: True
            halign: "center"
            valign: "middle"
            text_size: self.size
            size_hint_y: 0.35

        Label:
            text: app.circuit_status_text
            font_size: "18sp"
            size_hint_y: 0.1

        GridLayout:
            cols: 3
            spacing: dp(12)
            size_hint_y: 0.2

            Button:
                text: "Pune fir sus"
                font_size: "18sp"
                on_press: app.circuit_place_wire_top()
            Button:
                text: "ComutÄƒ Ã®ntrerupÄƒtor"
                font_size: "18sp"
                on_press: app.circuit_toggle_switch()
            Button:
                text: "Pune fir jos"
                font_size: "18sp"
                on_press: app.circuit_place_wire_bottom()

        BoxLayout:
            size_hint_y: 0.15
            spacing: dp(16)

            Button:
                text: "ReporneÈ™te"
                font_size: "20sp"
                on_press: app._reset_circuit()

            Button:
                text: "ÃŽnapoi"
                font_size: "20sp"
                on_press: app.go_home()

