#:kivy 2.3.0
#:import dp kivy.metrics.dp
#:import FadeTransition kivy.uix.screenmanager.FadeTransition
#:import SlideTransition kivy.uix.screenmanager.SlideTransition
#:import CircuitCanvas modules.circuit_canvas.CircuitCanvas
#:import MazeView modules.maze_view.MazeView

<Button>:
    background_normal: ''
    background_down: ''
    background_color: 0, 0, 0, 0
    color: 0.15, 0.15, 0.25, 1
    padding: dp(14), dp(12)
    font_size: "22sp"
    bold: True
    canvas.before:
        # UmbrƒÉ profundƒÉ multiplƒÉ pentru efect 3D puternic
        Color:
            rgba: 0, 0, 0, 0.5
        RoundedRectangle:
            pos: self.x + dp(5), self.y - dp(8)
            size: self.width - dp(10), self.height
            radius: [dp(20), dp(20), dp(20), dp(20)]
        Color:
            rgba: 0, 0, 0, 0.35
        RoundedRectangle:
            pos: self.x + dp(3), self.y - dp(5)
            size: self.width - dp(6), self.height + dp(2)
            radius: [dp(20), dp(20), dp(20), dp(20)]
        Color:
            rgba: 0, 0, 0, 0.2
        RoundedRectangle:
            pos: self.x + dp(1), self.y - dp(2)
            size: self.width - dp(2), self.height + dp(4)
            radius: [dp(20), dp(20), dp(20), dp(20)]
        # Gradient base modern (trei straturi pentru ad√¢ncime)
        Color:
            rgba: 0.75, 0.72, 0.62, 1
        RoundedRectangle:
            pos: self.x + dp(1), self.y + dp(1)
            size: self.width - dp(2), self.height - dp(2)
            radius: [dp(20), dp(20), dp(20), dp(20)]
        Color:
            rgba: 0.88, 0.85, 0.75, 1
        RoundedRectangle:
            pos: self.x + dp(2), self.y + dp(3)
            size: self.width - dp(4), self.height - dp(4)
            radius: [dp(20), dp(20), dp(20), dp(20)]
        Color:
            rgba: 1.0, 0.98, 0.92, 1
        RoundedRectangle:
            pos: self.x + dp(3), self.y + dp(5)
            size: self.width - dp(6), self.height - dp(6)
            radius: [dp(20), dp(20), dp(20), dp(20)]
        # Highlight puternic de sus - efect 3D premium
        Color:
            rgba: 1, 1, 1, 0.45
        RoundedRectangle:
            pos: self.x + dp(3), self.y + self.height * 0.75
            size: self.width - dp(6), self.height * 0.25
            radius: [dp(20), dp(20), 0, 0]
        # Highlight secundar
        Color:
            rgba: 1, 1, 1, 0.25
        RoundedRectangle:
            pos: self.x + dp(3), self.y + self.height * 0.65
            size: self.width - dp(6), self.height * 0.15
            radius: [dp(20), dp(20), 0, 0]
    canvas.after:
        # Glow exterior multiplu - efect neon avansat
        Color:
            rgba: 0.05, 0.78, 1, 0.4
        Line:
            width: dp(8)
            rounded_rectangle: (self.x - dp(3), self.y - dp(3), self.width + dp(6), self.height + dp(6), dp(20), dp(20), dp(20), dp(20))
        Color:
            rgba: 0.05, 0.78, 1, 0.25
        Line:
            width: dp(5)
            rounded_rectangle: (self.x - dp(1), self.y - dp(1), self.width + dp(2), self.height + dp(2), dp(20), dp(20), dp(20), dp(20))
        # Contur neon principal - mai groasƒÉ
        Color:
            rgba: 0.05, 0.78, 1, 1
        Line:
            width: dp(4)
            rounded_rectangle: (self.x, self.y, self.width, self.height, dp(20), dp(20), dp(20), dp(20))
        # Glow interior dublu - efect 3D premium
        Color:
            rgba: 0.25, 0.95, 1.0, 0.8
        Line:
            width: dp(2.5)
            rounded_rectangle: (self.x + dp(4), self.y + dp(4), self.width - dp(8), self.height - dp(8), dp(18), dp(18), dp(18), dp(18))
        Color:
            rgba: 0.4, 1.0, 1.0, 0.5
        Line:
            width: dp(1.5)
            rounded_rectangle: (self.x + dp(5), self.y + dp(5), self.width - dp(10), self.height - dp(10), dp(16), dp(16), dp(16), dp(16))

ScreenManager:
    id: screen_manager
    transition: FadeTransition(duration=0.5)
    HomeScreen:
        name: "home"
    InfoScreen:
        name: "info"
    PersonalityTestScreen:
        name: "personality"
    ScientistMatcherScreen:
        name: "scientist"
    RPSCameraGameScreen:
        name: "rps"
    MazeGameScreen:
        name: "maze"
    CircuitGameScreen:
        name: "circuit"


<HomeScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(24)
        spacing: dp(24)

        canvas.before:
            Color:
                rgba: 1, 1, 1, 1
            Rectangle:
                pos: self.pos
                size: self.size
                source: 'assets/images/wallpaperflare.com_wallpaper.jpg'

        # Titlu
        Label:
            text: "Universitatea DunƒÉrea de Jos Gala»õi"
            font_size: "46sp"
            bold: True
            color: 1, 1, 1, 1
            outline_width: 3
            outline_color: 0, 0, 0, 0.8
            size_hint_y: 0.2

        # Status prezen»õƒÉ
        Label:
            text: "Apropie-te de ecran pentru a √Æncepe" if not app.person_present else "Bun venit! Atinge un buton pentru a explora."
            font_size: "24sp"
            color: 1, 1, 1, 1
            outline_width: 2
            outline_color: 0, 0, 0, 0.8
            size_hint_y: 0.15

        # Butoanele principale - Layout √ÆmbunƒÉtƒÉ»õit
        BoxLayout:
            orientation: "vertical"
            spacing: dp(20)
            size_hint_y: 0.65
            padding: dp(10)

            # Primul r√¢nd - 3 butoane mari
            BoxLayout:
                spacing: dp(20)
                size_hint_y: 0.33

                Button:
                    text: "Informa»õii\ndespre universitate"
                    font_size: "20sp"
                    bold: True
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    on_press: app.open_university_website()
                    disabled: not app.person_present

                Button:
                    text: "Oracolul\nAI"
                    font_size: "20sp"
                    bold: True
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    on_press: root.manager.current = "personality"
                    disabled: not app.person_present

                Button:
                    text: "Geniul\ntƒÉu"
                    font_size: "20sp"
                    bold: True
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    on_press: root.manager.current = "scientist"
                    disabled: not app.person_present

            # Al doilea r√¢nd - 3 butoane mari
            BoxLayout:
                spacing: dp(20)
                size_hint_y: 0.33

                Button:
                    text: "Piatra-\nFoarfecƒÉ-AI"
                    font_size: "20sp"
                    bold: True
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    on_press: root.manager.current = "rps"
                    disabled: not app.person_present

                Button:
                    text: "Labirintul\nsecretelor"
                    font_size: "20sp"
                    bold: True
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    on_press: root.manager.current = "maze"
                    disabled: not app.person_present

                Button:
                    text: "Circuitul\nMagic"
                    font_size: "20sp"
                    bold: True
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    on_press: root.manager.current = "circuit"
                    disabled: not app.person_present


<InfoScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(24)
        spacing: dp(24)

        canvas.before:
            Color:
                rgba: 1, 1, 1, 1
            Rectangle:
                pos: self.pos
                size: self.size
                source: 'assets/images/wallpaperflare.com_wallpaper.jpg'

        Label:
            text: "Informa»õii despre universitate"
            font_size: "36sp"
            size_hint_y: 0.2

        Label:
            text: "Aici po»õi adƒÉuga o descriere a universitƒÉ»õii, facultƒÉ»õi, avantaje,\\nprograme de studiu, oportunitƒÉ»õi interna»õionale etc."
            font_size: "20sp"
            text_size: self.width * 0.9, None
            halign: "center"
            valign: "middle"
            size_hint_y: 0.6

        BoxLayout:
            size_hint_y: 0.2
            spacing: dp(16)

            Button:
                text: "Mai multe informa»õii"
                font_size: "20sp"
                on_press: app.open_university_website()

            Button:
                text: "√énapoi"
                font_size: "20sp"
                on_press: app.go_home()


<PersonalityTestScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(24)
        spacing: dp(24)

        canvas.before:
            Color:
                rgba: 1, 1, 1, 1
            Rectangle:
                pos: self.pos
                size: self.size
                source: 'assets/images/wallpaperflare.com_wallpaper.jpg'

        Label:
            text: "Test de personalitate"
            font_size: "36sp"
            size_hint_y: 0.2
        Label:
            text: app.personality_progress
            font_size: "18sp"
            size_hint_y: 0.1

        Label:
            id: question_label
            text: app.personality_question_text
            font_size: "22sp"
            halign: "center"
            valign: "middle"
            text_size: self.width * 0.9, None
            size_hint_y: 0.25

        GridLayout:
            cols: 1
            spacing: dp(12)
            size_hint_y: 0.35

            Button:
                text: app.personality_options[0] if len(app.personality_options) > 0 else " "
                font_size: "20sp"
                disabled: len(app.personality_options) < 1
                on_press: app.select_personality_answer(0)
            Button:
                text: app.personality_options[1] if len(app.personality_options) > 1 else " "
                font_size: "20sp"
                disabled: len(app.personality_options) < 2
                on_press: app.select_personality_answer(1)
            Button:
                text: app.personality_options[2] if len(app.personality_options) > 2 else " "
                font_size: "20sp"
                disabled: len(app.personality_options) < 3
                on_press: app.select_personality_answer(2)
            Button:
                text: app.personality_options[3] if len(app.personality_options) > 3 else " "
                font_size: "20sp"
                disabled: len(app.personality_options) < 4
                on_press: app.select_personality_answer(3)

        Label:
            text: app.personality_result_text
            font_size: "20sp"
            halign: "center"
            valign: "middle"
            text_size: self.size
            size_hint_y: 0.2

        Button:
            text: "Reporne»ôte testul"
            font_size: "20sp"
            size_hint_y: 0.15
            on_press: app._reset_personality_test()

        Button:
            text: "√énapoi"
            font_size: "20sp"
            size_hint_y: 0.15
            on_press: app.go_home()


<ScientistMatcherScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(24)
        spacing: dp(24)

        canvas.before:
            Color:
                rgba: 1, 1, 1, 1
            Rectangle:
                pos: self.pos
                size: self.size
                source: 'assets/images/wallpaperflare.com_wallpaper.jpg'

        Label:
            text: "Oameni de »ôtiin»õƒÉ care √Æ»õi seamƒÉnƒÉ"
            font_size: "36sp"
            size_hint_y: 0.2

        Label:
            text: app.scientist_status_text
            font_size: "18sp"
            halign: "center"
            valign: "middle"
            text_size: self.size
            size_hint_y: 0.5

        BoxLayout:
            orientation: "vertical"
            spacing: dp(12)
            size_hint_y: 0.35

            Button:
                text: "FƒÉ o pozƒÉ »ôi gƒÉse»ôte potrivirea"
                font_size: "20sp"
                size_hint_y: 0.5
                on_press: app.capture_scientist_match()

            Button:
                text: "DescarcƒÉ poza cu casca" if app.scientist_photo_path else "FƒÉ mai √Ænt√¢i o pozƒÉ"
                font_size: "20sp"
                size_hint_y: 0.5
                disabled: not app.scientist_photo_path
                on_press: app.download_scientist_photo()

        Button:
            text: "√énapoi"
            font_size: "20sp"
            size_hint_y: 0.15
            on_press: app.go_home()


<RPSCameraGameScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(24)
        spacing: dp(24)

        canvas.before:
            Color:
                rgba: 1, 1, 1, 1
            Rectangle:
                pos: self.pos
                size: self.size
                source: 'assets/images/wallpaperflare.com_wallpaper.jpg'

        Label:
            text: "Piatra - FoarfecƒÉ - H√¢rtie (camera)"
            font_size: "36sp"
            size_hint_y: 0.2

        Label:
            text: app.rps_status_text
            font_size: "20sp"
            halign: "center"
            valign: "middle"
            text_size: self.size
            size_hint_y: 0.6

        Button:
            text: "JoacƒÉ o rundƒÉ"
            font_size: "20sp"
            size_hint_y: 0.15
            on_press: app.play_rps_round()

        Button:
            text: "√énapoi"
            font_size: "20sp"
            size_hint_y: 0.15
            on_press: app.go_home()


<MazeGameScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(24)
        spacing: dp(20)

        canvas.before:
            Color:
                rgba: 1, 1, 1, 1
            Rectangle:
                pos: self.pos
                size: self.size
                source: 'assets/images/wallpaperflare.com_wallpaper.jpg'

        Label:
            text: "Labirint interactiv"
            font_size: "38sp"
            bold: True
            size_hint_y: 0.14

        Label:
            text: app.maze_status_text
            font_size: "18sp"
            size_hint_y: 0.08

        BoxLayout:
            size_hint_y: 0.6
            padding: dp(10)
            spacing: dp(10)
            canvas.before:
                Color:
                    rgba: 0.85, 0.90, 0.94, 1
                Rectangle:
                    pos: self.pos
                    size: self.size
                Color:
                    rgba: 1, 1, 1, 0.2
                Line:
                    width: 2
                    rectangle: (self.x, self.y, self.width, self.height)

            MazeView:
                id: maze_view
                grid: app.maze_grid
                on_swipe: app.move_maze(args[1])

        BoxLayout:
            size_hint_y: 0.1
            spacing: dp(12)

            Label:
                text: "Legende: pere»õi = blocuri √Æntunecate | ‚òÖ ie»ôire | üôÇ tu"
                font_size: "16sp"
                halign: "left"
                valign: "middle"
                text_size: self.size
            Label:
                text: "GliseazƒÉ pe hartƒÉ sau folose»ôte sƒÉge»õile"
                font_size: "16sp"
                halign: "right"
                valign: "middle"
                text_size: self.size

        GridLayout:
            cols: 3
            spacing: dp(12)
            size_hint_y: 0.16

            Widget:
            Button:
                text: "‚Üë"
                font_size: "26sp"
                background_color: 0.16, 0.45, 0.40, 1
                background_normal: ''
                on_press: app.move_maze("up")
            Widget:

            Button:
                text: "‚Üê"
                font_size: "26sp"
                background_color: 0.16, 0.45, 0.40, 1
                background_normal: ''
                on_press: app.move_maze("left")
            Widget:
            Button:
                text: "‚Üí"
                font_size: "26sp"
                background_color: 0.16, 0.45, 0.40, 1
                background_normal: ''
                on_press: app.move_maze("right")

            Widget:
            Button:
                text: "‚Üì"
                font_size: "26sp"
                background_color: 0.16, 0.45, 0.40, 1
                background_normal: ''
                on_press: app.move_maze("down")
            Widget:

        BoxLayout:
            size_hint_y: 0.14
            spacing: dp(16)

            Button:
                text: "Reporne»ôte"
                font_size: "20sp"
                on_press: app._reset_maze()

            Button:
                text: "√énapoi"
                font_size: "20sp"
                on_press: app.go_home()


<CircuitGameScreen>:
    BoxLayout:
        orientation: "vertical"
        padding: dp(24)
        spacing: dp(20)

        canvas.before:
            Color:
                rgba: 1, 1, 1, 1
            Rectangle:
                pos: self.pos
                size: self.size
                source: 'assets/images/wallpaperflare.com_wallpaper.jpg'

        Label:
            text: "Circuitul Magic"
            font_size: "36sp"
            bold: True
            size_hint_y: 0.12

        Label:
            text: "ConecteazƒÉ firele trƒÉg√¢nd cu degetul de la terminalele componentei:\n1. De la terminalul + al bateriei la terminalul de intrare al √ÆntrerupƒÉtorului\n2. De la terminalul de ie»ôire al √ÆntrerupƒÉtorului la terminalele becului\n3. ApasƒÉ butonul pentru a porni √ÆntrerupƒÉtorul"
            font_size: "15sp"
            halign: "center"
            valign: "middle"
            text_size: self.width * 0.95, None
            size_hint_y: 0.18

        CircuitCanvas:
            id: circuit_canvas
            size_hint_y: 0.5

        Label:
            text: app.circuit_status_text
            font_size: "18sp"
            halign: "center"
            valign: "middle"
            text_size: self.width * 0.9, None
            size_hint_y: 0.1

        BoxLayout:
            size_hint_y: 0.15
            spacing: dp(16)

            Button:
                text: "Porne»ôte/Opre»ôte\n√éntrerupƒÉtorul"
                font_size: "18sp"
                on_press: app.circuit_toggle_switch()

            Button:
                text: "ReseteazƒÉ"
                font_size: "20sp"
                on_press: app._reset_circuit()

            Button:
                text: "√énapoi"
                font_size: "20sp"
                on_press: app.go_home()

